{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nvar __decorate = this && this.__decorate || function (decorators, target, key, desc) {\n  var c = arguments.length,\n      r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc,\n      d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\n\nvar __param = this && this.__param || function (paramIndex, decorator) {\n  return function (target, key) {\n    decorator(target, key, paramIndex);\n  };\n};\n\nimport * as nls from '../../../nls.js';\nimport { Delayer } from '../../../base/common/async.js';\nimport { Disposable } from '../../../base/common/lifecycle.js';\nimport * as strings from '../../../base/common/strings.js';\nimport { EditorAction, EditorCommand, registerEditorAction, registerEditorCommand, registerEditorContribution } from '../../browser/editorExtensions.js';\nimport { EditorContextKeys } from '../../common/editorContextKeys.js';\nimport { CONTEXT_FIND_INPUT_FOCUSED, CONTEXT_FIND_WIDGET_VISIBLE, FIND_IDS, FindModelBoundToEditorModel, ToggleCaseSensitiveKeybinding, ToggleRegexKeybinding, ToggleSearchScopeKeybinding, ToggleWholeWordKeybinding, CONTEXT_REPLACE_INPUT_FOCUSED } from './findModel.js';\nimport { FindOptionsWidget } from './findOptionsWidget.js';\nimport { FindReplaceState } from './findState.js';\nimport { FindWidget } from './findWidget.js';\nimport { IClipboardService } from '../../../platform/clipboard/common/clipboardService.js';\nimport { IContextKeyService, ContextKeyExpr } from '../../../platform/contextkey/common/contextkey.js';\nimport { IContextViewService } from '../../../platform/contextview/browser/contextView.js';\nimport { optional } from '../../../platform/instantiation/common/instantiation.js';\nimport { IKeybindingService } from '../../../platform/keybinding/common/keybinding.js';\nimport { IStorageService } from '../../../platform/storage/common/storage.js';\nimport { IThemeService } from '../../../platform/theme/common/themeService.js';\nimport { INotificationService } from '../../../platform/notification/common/notification.js';\nvar SEARCH_STRING_MAX_LENGTH = 524288;\nexport function getSelectionSearchString(editor) {\n  if (!editor.hasModel()) {\n    return null;\n  }\n\n  var selection = editor.getSelection(); // if selection spans multiple lines, default search string to empty\n\n  if (selection.startLineNumber === selection.endLineNumber) {\n    if (selection.isEmpty()) {\n      var wordAtPosition = editor.getModel().getWordAtPosition(selection.getStartPosition());\n\n      if (wordAtPosition) {\n        return wordAtPosition.word;\n      }\n    } else {\n      if (editor.getModel().getValueLengthInRange(selection) < SEARCH_STRING_MAX_LENGTH) {\n        return editor.getModel().getValueInRange(selection);\n      }\n    }\n  }\n\n  return null;\n}\n\nvar CommonFindController =\n/** @class */\nfunction (_super) {\n  __extends(CommonFindController, _super);\n\n  function CommonFindController(editor, contextKeyService, storageService, clipboardService) {\n    var _this = _super.call(this) || this;\n\n    _this._editor = editor;\n    _this._findWidgetVisible = CONTEXT_FIND_WIDGET_VISIBLE.bindTo(contextKeyService);\n    _this._contextKeyService = contextKeyService;\n    _this._storageService = storageService;\n    _this._clipboardService = clipboardService;\n    _this._updateHistoryDelayer = new Delayer(500);\n    _this._state = _this._register(new FindReplaceState());\n\n    _this.loadQueryState();\n\n    _this._register(_this._state.onFindReplaceStateChange(function (e) {\n      return _this._onStateChanged(e);\n    }));\n\n    _this._model = null;\n\n    _this._register(_this._editor.onDidChangeModel(function () {\n      var shouldRestartFind = _this._editor.getModel() && _this._state.isRevealed;\n\n      _this.disposeModel();\n\n      _this._state.change({\n        searchScope: null,\n        matchCase: _this._storageService.getBoolean('editor.matchCase', 1\n        /* WORKSPACE */\n        , false),\n        wholeWord: _this._storageService.getBoolean('editor.wholeWord', 1\n        /* WORKSPACE */\n        , false),\n        isRegex: _this._storageService.getBoolean('editor.isRegex', 1\n        /* WORKSPACE */\n        , false),\n        preserveCase: _this._storageService.getBoolean('editor.preserveCase', 1\n        /* WORKSPACE */\n        , false)\n      }, false);\n\n      if (shouldRestartFind) {\n        _this._start({\n          forceRevealReplace: false,\n          seedSearchStringFromSelection: false && _this._editor.getConfiguration().contribInfo.find.seedSearchStringFromSelection,\n          seedSearchStringFromGlobalClipboard: false,\n          shouldFocus: 0\n          /* NoFocusChange */\n          ,\n          shouldAnimate: false,\n          updateSearchScope: false\n        });\n      }\n    }));\n\n    return _this;\n  }\n\n  CommonFindController.get = function (editor) {\n    return editor.getContribution(CommonFindController.ID);\n  };\n\n  CommonFindController.prototype.dispose = function () {\n    this.disposeModel();\n\n    _super.prototype.dispose.call(this);\n  };\n\n  CommonFindController.prototype.disposeModel = function () {\n    if (this._model) {\n      this._model.dispose();\n\n      this._model = null;\n    }\n  };\n\n  CommonFindController.prototype.getId = function () {\n    return CommonFindController.ID;\n  };\n\n  CommonFindController.prototype._onStateChanged = function (e) {\n    this.saveQueryState(e);\n\n    if (e.isRevealed) {\n      if (this._state.isRevealed) {\n        this._findWidgetVisible.set(true);\n      } else {\n        this._findWidgetVisible.reset();\n\n        this.disposeModel();\n      }\n    }\n\n    if (e.searchString) {\n      this.setGlobalBufferTerm(this._state.searchString);\n    }\n  };\n\n  CommonFindController.prototype.saveQueryState = function (e) {\n    if (e.isRegex) {\n      this._storageService.store('editor.isRegex', this._state.actualIsRegex, 1\n      /* WORKSPACE */\n      );\n    }\n\n    if (e.wholeWord) {\n      this._storageService.store('editor.wholeWord', this._state.actualWholeWord, 1\n      /* WORKSPACE */\n      );\n    }\n\n    if (e.matchCase) {\n      this._storageService.store('editor.matchCase', this._state.actualMatchCase, 1\n      /* WORKSPACE */\n      );\n    }\n\n    if (e.preserveCase) {\n      this._storageService.store('editor.preserveCase', this._state.actualPreserveCase, 1\n      /* WORKSPACE */\n      );\n    }\n  };\n\n  CommonFindController.prototype.loadQueryState = function () {\n    this._state.change({\n      matchCase: this._storageService.getBoolean('editor.matchCase', 1\n      /* WORKSPACE */\n      , this._state.matchCase),\n      wholeWord: this._storageService.getBoolean('editor.wholeWord', 1\n      /* WORKSPACE */\n      , this._state.wholeWord),\n      isRegex: this._storageService.getBoolean('editor.isRegex', 1\n      /* WORKSPACE */\n      , this._state.isRegex),\n      preserveCase: this._storageService.getBoolean('editor.preserveCase', 1\n      /* WORKSPACE */\n      , this._state.preserveCase)\n    }, false);\n  };\n\n  CommonFindController.prototype.isFindInputFocused = function () {\n    return !!CONTEXT_FIND_INPUT_FOCUSED.getValue(this._contextKeyService);\n  };\n\n  CommonFindController.prototype.getState = function () {\n    return this._state;\n  };\n\n  CommonFindController.prototype.closeFindWidget = function () {\n    this._state.change({\n      isRevealed: false,\n      searchScope: null\n    }, false);\n\n    this._editor.focus();\n  };\n\n  CommonFindController.prototype.toggleCaseSensitive = function () {\n    this._state.change({\n      matchCase: !this._state.matchCase\n    }, false);\n\n    if (!this._state.isRevealed) {\n      this.highlightFindOptions();\n    }\n  };\n\n  CommonFindController.prototype.toggleWholeWords = function () {\n    this._state.change({\n      wholeWord: !this._state.wholeWord\n    }, false);\n\n    if (!this._state.isRevealed) {\n      this.highlightFindOptions();\n    }\n  };\n\n  CommonFindController.prototype.toggleRegex = function () {\n    this._state.change({\n      isRegex: !this._state.isRegex\n    }, false);\n\n    if (!this._state.isRevealed) {\n      this.highlightFindOptions();\n    }\n  };\n\n  CommonFindController.prototype.toggleSearchScope = function () {\n    if (this._state.searchScope) {\n      this._state.change({\n        searchScope: null\n      }, true);\n    } else {\n      if (this._editor.hasModel()) {\n        var selection = this._editor.getSelection();\n\n        if (selection.endColumn === 1 && selection.endLineNumber > selection.startLineNumber) {\n          selection = selection.setEndPosition(selection.endLineNumber - 1, this._editor.getModel().getLineMaxColumn(selection.endLineNumber - 1));\n        }\n\n        if (!selection.isEmpty()) {\n          this._state.change({\n            searchScope: selection\n          }, true);\n        }\n      }\n    }\n  };\n\n  CommonFindController.prototype.setSearchString = function (searchString) {\n    if (this._state.isRegex) {\n      searchString = strings.escapeRegExpCharacters(searchString);\n    }\n\n    this._state.change({\n      searchString: searchString\n    }, false);\n  };\n\n  CommonFindController.prototype.highlightFindOptions = function () {// overwritten in subclass\n  };\n\n  CommonFindController.prototype._start = function (opts) {\n    this.disposeModel();\n\n    if (!this._editor.hasModel()) {\n      // cannot do anything with an editor that doesn't have a model...\n      return;\n    }\n\n    var stateChanges = {\n      isRevealed: true\n    };\n\n    if (opts.seedSearchStringFromSelection) {\n      var selectionSearchString = getSelectionSearchString(this._editor);\n\n      if (selectionSearchString) {\n        if (this._state.isRegex) {\n          stateChanges.searchString = strings.escapeRegExpCharacters(selectionSearchString);\n        } else {\n          stateChanges.searchString = selectionSearchString;\n        }\n      }\n    }\n\n    if (!stateChanges.searchString && opts.seedSearchStringFromGlobalClipboard) {\n      var selectionSearchString = this.getGlobalBufferTerm();\n\n      if (selectionSearchString) {\n        stateChanges.searchString = selectionSearchString;\n      }\n    } // Overwrite isReplaceRevealed\n\n\n    if (opts.forceRevealReplace) {\n      stateChanges.isReplaceRevealed = true;\n    } else if (!this._findWidgetVisible.get()) {\n      stateChanges.isReplaceRevealed = false;\n    }\n\n    if (opts.updateSearchScope) {\n      var currentSelection = this._editor.getSelection();\n\n      if (!currentSelection.isEmpty()) {\n        stateChanges.searchScope = currentSelection;\n      }\n    }\n\n    this._state.change(stateChanges, false);\n\n    if (!this._model) {\n      this._model = new FindModelBoundToEditorModel(this._editor, this._state);\n    }\n  };\n\n  CommonFindController.prototype.start = function (opts) {\n    this._start(opts);\n  };\n\n  CommonFindController.prototype.moveToNextMatch = function () {\n    if (this._model) {\n      this._model.moveToNextMatch();\n\n      return true;\n    }\n\n    return false;\n  };\n\n  CommonFindController.prototype.moveToPrevMatch = function () {\n    if (this._model) {\n      this._model.moveToPrevMatch();\n\n      return true;\n    }\n\n    return false;\n  };\n\n  CommonFindController.prototype.replace = function () {\n    if (this._model) {\n      this._model.replace();\n\n      return true;\n    }\n\n    return false;\n  };\n\n  CommonFindController.prototype.replaceAll = function () {\n    if (this._model) {\n      this._model.replaceAll();\n\n      return true;\n    }\n\n    return false;\n  };\n\n  CommonFindController.prototype.selectAllMatches = function () {\n    if (this._model) {\n      this._model.selectAllMatches();\n\n      this._editor.focus();\n\n      return true;\n    }\n\n    return false;\n  };\n\n  CommonFindController.prototype.getGlobalBufferTerm = function () {\n    if (this._editor.getConfiguration().contribInfo.find.globalFindClipboard && this._clipboardService && this._editor.hasModel() && !this._editor.getModel().isTooLargeForSyncing()) {\n      return this._clipboardService.readFindText();\n    }\n\n    return '';\n  };\n\n  CommonFindController.prototype.setGlobalBufferTerm = function (text) {\n    if (this._editor.getConfiguration().contribInfo.find.globalFindClipboard && this._clipboardService && this._editor.hasModel() && !this._editor.getModel().isTooLargeForSyncing()) {\n      this._clipboardService.writeFindText(text);\n    }\n  };\n\n  CommonFindController.ID = 'editor.contrib.findController';\n  CommonFindController = __decorate([__param(1, IContextKeyService), __param(2, IStorageService), __param(3, IClipboardService)], CommonFindController);\n  return CommonFindController;\n}(Disposable);\n\nexport { CommonFindController };\n\nvar FindController =\n/** @class */\nfunction (_super) {\n  __extends(FindController, _super);\n\n  function FindController(editor, _contextViewService, _contextKeyService, _keybindingService, _themeService, _notificationService, _storageService, clipboardService) {\n    var _this = _super.call(this, editor, _contextKeyService, _storageService, clipboardService) || this;\n\n    _this._contextViewService = _contextViewService;\n    _this._keybindingService = _keybindingService;\n    _this._themeService = _themeService;\n    _this._notificationService = _notificationService;\n    _this._widget = null;\n    _this._findOptionsWidget = null;\n    return _this;\n  }\n\n  FindController.prototype._start = function (opts) {\n    if (!this._widget) {\n      this._createFindWidget();\n    }\n\n    if (!this._widget.getPosition() && this._editor.getConfiguration().contribInfo.find.autoFindInSelection) {\n      // not visible yet so we need to set search scope if `editor.find.autoFindInSelection` is `true`\n      opts.updateSearchScope = true;\n    }\n\n    _super.prototype._start.call(this, opts);\n\n    if (opts.shouldFocus === 2\n    /* FocusReplaceInput */\n    ) {\n        this._widget.focusReplaceInput();\n      } else if (opts.shouldFocus === 1\n    /* FocusFindInput */\n    ) {\n        this._widget.focusFindInput();\n      }\n  };\n\n  FindController.prototype.highlightFindOptions = function () {\n    if (!this._widget) {\n      this._createFindWidget();\n    }\n\n    if (this._state.isRevealed) {\n      this._widget.highlightFindOptions();\n    } else {\n      this._findOptionsWidget.highlightFindOptions();\n    }\n  };\n\n  FindController.prototype._createFindWidget = function () {\n    this._widget = this._register(new FindWidget(this._editor, this, this._state, this._contextViewService, this._keybindingService, this._contextKeyService, this._themeService, this._storageService, this._notificationService));\n    this._findOptionsWidget = this._register(new FindOptionsWidget(this._editor, this._state, this._keybindingService, this._themeService));\n  };\n\n  FindController = __decorate([__param(1, IContextViewService), __param(2, IContextKeyService), __param(3, IKeybindingService), __param(4, IThemeService), __param(5, INotificationService), __param(6, IStorageService), __param(7, optional(IClipboardService))], FindController);\n  return FindController;\n}(CommonFindController);\n\nexport { FindController };\n\nvar StartFindAction =\n/** @class */\nfunction (_super) {\n  __extends(StartFindAction, _super);\n\n  function StartFindAction() {\n    return _super.call(this, {\n      id: FIND_IDS.StartFindAction,\n      label: nls.localize('startFindAction', \"Find\"),\n      alias: 'Find',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: null,\n        primary: 2048\n        /* CtrlCmd */\n        | 36\n        /* KEY_F */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      },\n      menubarOpts: {\n        menuId: 14\n        /* MenubarEditMenu */\n        ,\n        group: '3_find',\n        title: nls.localize({\n          key: 'miFind',\n          comment: ['&& denotes a mnemonic']\n        }, \"&&Find\"),\n        order: 1\n      }\n    }) || this;\n  }\n\n  StartFindAction.prototype.run = function (accessor, editor) {\n    var controller = CommonFindController.get(editor);\n\n    if (controller) {\n      controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: editor.getConfiguration().contribInfo.find.seedSearchStringFromSelection,\n        seedSearchStringFromGlobalClipboard: editor.getConfiguration().contribInfo.find.globalFindClipboard,\n        shouldFocus: 1\n        /* FocusFindInput */\n        ,\n        shouldAnimate: true,\n        updateSearchScope: false\n      });\n    }\n  };\n\n  return StartFindAction;\n}(EditorAction);\n\nexport { StartFindAction };\n\nvar StartFindWithSelectionAction =\n/** @class */\nfunction (_super) {\n  __extends(StartFindWithSelectionAction, _super);\n\n  function StartFindWithSelectionAction() {\n    return _super.call(this, {\n      id: FIND_IDS.StartFindWithSelection,\n      label: nls.localize('startFindWithSelectionAction', \"Find With Selection\"),\n      alias: 'Find With Selection',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: null,\n        primary: 0,\n        mac: {\n          primary: 2048\n          /* CtrlCmd */\n          | 35\n          /* KEY_E */\n\n        },\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  StartFindWithSelectionAction.prototype.run = function (accessor, editor) {\n    var controller = CommonFindController.get(editor);\n\n    if (controller) {\n      controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: true,\n        seedSearchStringFromGlobalClipboard: false,\n        shouldFocus: 1\n        /* FocusFindInput */\n        ,\n        shouldAnimate: true,\n        updateSearchScope: false\n      });\n      controller.setGlobalBufferTerm(controller.getState().searchString);\n    }\n  };\n\n  return StartFindWithSelectionAction;\n}(EditorAction);\n\nexport { StartFindWithSelectionAction };\n\nvar MatchFindAction =\n/** @class */\nfunction (_super) {\n  __extends(MatchFindAction, _super);\n\n  function MatchFindAction() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  MatchFindAction.prototype.run = function (accessor, editor) {\n    var controller = CommonFindController.get(editor);\n\n    if (controller && !this._run(controller)) {\n      controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: controller.getState().searchString.length === 0 && editor.getConfiguration().contribInfo.find.seedSearchStringFromSelection,\n        seedSearchStringFromGlobalClipboard: true,\n        shouldFocus: 0\n        /* NoFocusChange */\n        ,\n        shouldAnimate: true,\n        updateSearchScope: false\n      });\n\n      this._run(controller);\n    }\n  };\n\n  return MatchFindAction;\n}(EditorAction);\n\nexport { MatchFindAction };\n\nvar NextMatchFindAction =\n/** @class */\nfunction (_super) {\n  __extends(NextMatchFindAction, _super);\n\n  function NextMatchFindAction() {\n    return _super.call(this, {\n      id: FIND_IDS.NextMatchFindAction,\n      label: nls.localize('findNextMatchAction', \"Find Next\"),\n      alias: 'Find Next',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: EditorContextKeys.focus,\n        primary: 61\n        /* F3 */\n        ,\n        mac: {\n          primary: 2048\n          /* CtrlCmd */\n          | 37\n          /* KEY_G */\n          ,\n          secondary: [61\n          /* F3 */\n          ]\n        },\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  NextMatchFindAction.prototype._run = function (controller) {\n    return controller.moveToNextMatch();\n  };\n\n  return NextMatchFindAction;\n}(MatchFindAction);\n\nexport { NextMatchFindAction };\n\nvar NextMatchFindAction2 =\n/** @class */\nfunction (_super) {\n  __extends(NextMatchFindAction2, _super);\n\n  function NextMatchFindAction2() {\n    return _super.call(this, {\n      id: FIND_IDS.NextMatchFindAction,\n      label: nls.localize('findNextMatchAction', \"Find Next\"),\n      alias: 'Find Next',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n        primary: 3\n        /* Enter */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  NextMatchFindAction2.prototype._run = function (controller) {\n    return controller.moveToNextMatch();\n  };\n\n  return NextMatchFindAction2;\n}(MatchFindAction);\n\nexport { NextMatchFindAction2 };\n\nvar PreviousMatchFindAction =\n/** @class */\nfunction (_super) {\n  __extends(PreviousMatchFindAction, _super);\n\n  function PreviousMatchFindAction() {\n    return _super.call(this, {\n      id: FIND_IDS.PreviousMatchFindAction,\n      label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\n      alias: 'Find Previous',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: EditorContextKeys.focus,\n        primary: 1024\n        /* Shift */\n        | 61\n        /* F3 */\n        ,\n        mac: {\n          primary: 2048\n          /* CtrlCmd */\n          | 1024\n          /* Shift */\n          | 37\n          /* KEY_G */\n          ,\n          secondary: [1024\n          /* Shift */\n          | 61\n          /* F3 */\n          ]\n        },\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  PreviousMatchFindAction.prototype._run = function (controller) {\n    return controller.moveToPrevMatch();\n  };\n\n  return PreviousMatchFindAction;\n}(MatchFindAction);\n\nexport { PreviousMatchFindAction };\n\nvar PreviousMatchFindAction2 =\n/** @class */\nfunction (_super) {\n  __extends(PreviousMatchFindAction2, _super);\n\n  function PreviousMatchFindAction2() {\n    return _super.call(this, {\n      id: FIND_IDS.PreviousMatchFindAction,\n      label: nls.localize('findPreviousMatchAction', \"Find Previous\"),\n      alias: 'Find Previous',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_FIND_INPUT_FOCUSED),\n        primary: 1024\n        /* Shift */\n        | 3\n        /* Enter */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  PreviousMatchFindAction2.prototype._run = function (controller) {\n    return controller.moveToPrevMatch();\n  };\n\n  return PreviousMatchFindAction2;\n}(MatchFindAction);\n\nexport { PreviousMatchFindAction2 };\n\nvar SelectionMatchFindAction =\n/** @class */\nfunction (_super) {\n  __extends(SelectionMatchFindAction, _super);\n\n  function SelectionMatchFindAction() {\n    return _super !== null && _super.apply(this, arguments) || this;\n  }\n\n  SelectionMatchFindAction.prototype.run = function (accessor, editor) {\n    var controller = CommonFindController.get(editor);\n\n    if (!controller) {\n      return;\n    }\n\n    var selectionSearchString = getSelectionSearchString(editor);\n\n    if (selectionSearchString) {\n      controller.setSearchString(selectionSearchString);\n    }\n\n    if (!this._run(controller)) {\n      controller.start({\n        forceRevealReplace: false,\n        seedSearchStringFromSelection: editor.getConfiguration().contribInfo.find.seedSearchStringFromSelection,\n        seedSearchStringFromGlobalClipboard: false,\n        shouldFocus: 0\n        /* NoFocusChange */\n        ,\n        shouldAnimate: true,\n        updateSearchScope: false\n      });\n\n      this._run(controller);\n    }\n  };\n\n  return SelectionMatchFindAction;\n}(EditorAction);\n\nexport { SelectionMatchFindAction };\n\nvar NextSelectionMatchFindAction =\n/** @class */\nfunction (_super) {\n  __extends(NextSelectionMatchFindAction, _super);\n\n  function NextSelectionMatchFindAction() {\n    return _super.call(this, {\n      id: FIND_IDS.NextSelectionMatchFindAction,\n      label: nls.localize('nextSelectionMatchFindAction', \"Find Next Selection\"),\n      alias: 'Find Next Selection',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048\n        /* CtrlCmd */\n        | 61\n        /* F3 */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  NextSelectionMatchFindAction.prototype._run = function (controller) {\n    return controller.moveToNextMatch();\n  };\n\n  return NextSelectionMatchFindAction;\n}(SelectionMatchFindAction);\n\nexport { NextSelectionMatchFindAction };\n\nvar PreviousSelectionMatchFindAction =\n/** @class */\nfunction (_super) {\n  __extends(PreviousSelectionMatchFindAction, _super);\n\n  function PreviousSelectionMatchFindAction() {\n    return _super.call(this, {\n      id: FIND_IDS.PreviousSelectionMatchFindAction,\n      label: nls.localize('previousSelectionMatchFindAction', \"Find Previous Selection\"),\n      alias: 'Find Previous Selection',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: EditorContextKeys.focus,\n        primary: 2048\n        /* CtrlCmd */\n        | 1024\n        /* Shift */\n        | 61\n        /* F3 */\n        ,\n        weight: 100\n        /* EditorContrib */\n\n      }\n    }) || this;\n  }\n\n  PreviousSelectionMatchFindAction.prototype._run = function (controller) {\n    return controller.moveToPrevMatch();\n  };\n\n  return PreviousSelectionMatchFindAction;\n}(SelectionMatchFindAction);\n\nexport { PreviousSelectionMatchFindAction };\n\nvar StartFindReplaceAction =\n/** @class */\nfunction (_super) {\n  __extends(StartFindReplaceAction, _super);\n\n  function StartFindReplaceAction() {\n    return _super.call(this, {\n      id: FIND_IDS.StartFindReplaceAction,\n      label: nls.localize('startReplace', \"Replace\"),\n      alias: 'Replace',\n      precondition: undefined,\n      kbOpts: {\n        kbExpr: null,\n        primary: 2048\n        /* CtrlCmd */\n        | 38\n        /* KEY_H */\n        ,\n        mac: {\n          primary: 2048\n          /* CtrlCmd */\n          | 512\n          /* Alt */\n          | 36\n          /* KEY_F */\n\n        },\n        weight: 100\n        /* EditorContrib */\n\n      },\n      menubarOpts: {\n        menuId: 14\n        /* MenubarEditMenu */\n        ,\n        group: '3_find',\n        title: nls.localize({\n          key: 'miReplace',\n          comment: ['&& denotes a mnemonic']\n        }, \"&&Replace\"),\n        order: 2\n      }\n    }) || this;\n  }\n\n  StartFindReplaceAction.prototype.run = function (accessor, editor) {\n    if (!editor.hasModel() || editor.getConfiguration().readOnly) {\n      return;\n    }\n\n    var controller = CommonFindController.get(editor);\n    var currentSelection = editor.getSelection();\n    var findInputFocused = controller.isFindInputFocused(); // we only seed search string from selection when the current selection is single line and not empty,\n    // + the find input is not focused\n\n    var seedSearchStringFromSelection = !currentSelection.isEmpty() && currentSelection.startLineNumber === currentSelection.endLineNumber && editor.getConfiguration().contribInfo.find.seedSearchStringFromSelection && !findInputFocused;\n    /*\n     * if the existing search string in find widget is empty and we don't seed search string from selection, it means the Find Input is still empty, so we should focus the Find Input instead of Replace Input.\n      * findInputFocused true -> seedSearchStringFromSelection false, FocusReplaceInput\n     * findInputFocused false, seedSearchStringFromSelection true FocusReplaceInput\n     * findInputFocused false seedSearchStringFromSelection false FocusFindInput\n     */\n\n    var shouldFocus = findInputFocused || seedSearchStringFromSelection ? 2\n    /* FocusReplaceInput */\n    : 1\n    /* FocusFindInput */\n    ;\n\n    if (controller) {\n      controller.start({\n        forceRevealReplace: true,\n        seedSearchStringFromSelection: seedSearchStringFromSelection,\n        seedSearchStringFromGlobalClipboard: editor.getConfiguration().contribInfo.find.seedSearchStringFromSelection,\n        shouldFocus: shouldFocus,\n        shouldAnimate: true,\n        updateSearchScope: false\n      });\n    }\n  };\n\n  return StartFindReplaceAction;\n}(EditorAction);\n\nexport { StartFindReplaceAction };\nregisterEditorContribution(FindController);\nregisterEditorAction(StartFindAction);\nregisterEditorAction(StartFindWithSelectionAction);\nregisterEditorAction(NextMatchFindAction);\nregisterEditorAction(NextMatchFindAction2);\nregisterEditorAction(PreviousMatchFindAction);\nregisterEditorAction(PreviousMatchFindAction2);\nregisterEditorAction(NextSelectionMatchFindAction);\nregisterEditorAction(PreviousSelectionMatchFindAction);\nregisterEditorAction(StartFindReplaceAction);\nvar FindCommand = EditorCommand.bindToContribution(CommonFindController.get);\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.CloseFindWidgetCommand,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: function (x) {\n    return x.closeFindWidget();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: 9\n    /* Escape */\n    ,\n    secondary: [1024\n    /* Shift */\n    | 9\n    /* Escape */\n    ]\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ToggleCaseSensitiveCommand,\n  precondition: undefined,\n  handler: function (x) {\n    return x.toggleCaseSensitive();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: ToggleCaseSensitiveKeybinding.primary,\n    mac: ToggleCaseSensitiveKeybinding.mac,\n    win: ToggleCaseSensitiveKeybinding.win,\n    linux: ToggleCaseSensitiveKeybinding.linux\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ToggleWholeWordCommand,\n  precondition: undefined,\n  handler: function (x) {\n    return x.toggleWholeWords();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: ToggleWholeWordKeybinding.primary,\n    mac: ToggleWholeWordKeybinding.mac,\n    win: ToggleWholeWordKeybinding.win,\n    linux: ToggleWholeWordKeybinding.linux\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ToggleRegexCommand,\n  precondition: undefined,\n  handler: function (x) {\n    return x.toggleRegex();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: ToggleRegexKeybinding.primary,\n    mac: ToggleRegexKeybinding.mac,\n    win: ToggleRegexKeybinding.win,\n    linux: ToggleRegexKeybinding.linux\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ToggleSearchScopeCommand,\n  precondition: undefined,\n  handler: function (x) {\n    return x.toggleSearchScope();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: ToggleSearchScopeKeybinding.primary,\n    mac: ToggleSearchScopeKeybinding.mac,\n    win: ToggleSearchScopeKeybinding.win,\n    linux: ToggleSearchScopeKeybinding.linux\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ReplaceOneAction,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: function (x) {\n    return x.replace();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: 2048\n    /* CtrlCmd */\n    | 1024\n    /* Shift */\n    | 22\n    /* KEY_1 */\n\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ReplaceOneAction,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: function (x) {\n    return x.replace();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 5,\n    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n    primary: 3\n    /* Enter */\n\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ReplaceAllAction,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: function (x) {\n    return x.replaceAll();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: 2048\n    /* CtrlCmd */\n    | 512\n    /* Alt */\n    | 3\n    /* Enter */\n\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.ReplaceAllAction,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: function (x) {\n    return x.replaceAll();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 5,\n    kbExpr: ContextKeyExpr.and(EditorContextKeys.focus, CONTEXT_REPLACE_INPUT_FOCUSED),\n    primary: undefined,\n    mac: {\n      primary: 2048\n      /* CtrlCmd */\n      | 3\n      /* Enter */\n\n    }\n  }\n}));\nregisterEditorCommand(new FindCommand({\n  id: FIND_IDS.SelectAllMatchesAction,\n  precondition: CONTEXT_FIND_WIDGET_VISIBLE,\n  handler: function (x) {\n    return x.selectAllMatches();\n  },\n  kbOpts: {\n    weight: 100\n    /* EditorContrib */\n    + 5,\n    kbExpr: EditorContextKeys.focus,\n    primary: 512\n    /* Alt */\n    | 3\n    /* Enter */\n\n  }\n}));","map":null,"metadata":{},"sourceType":"module"}