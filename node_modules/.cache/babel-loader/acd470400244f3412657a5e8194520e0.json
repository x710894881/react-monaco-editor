{"ast":null,"code":"/*---------------------------------------------------------------------------------------------\n *  Copyright (c) Microsoft Corporation. All rights reserved.\n *  Licensed under the MIT License. See License.txt in the project root for license information.\n *--------------------------------------------------------------------------------------------*/\n'use strict';\n\nexport var TokenType;\n\n(function (TokenType) {\n  TokenType[TokenType[\"Ident\"] = 0] = \"Ident\";\n  TokenType[TokenType[\"AtKeyword\"] = 1] = \"AtKeyword\";\n  TokenType[TokenType[\"String\"] = 2] = \"String\";\n  TokenType[TokenType[\"BadString\"] = 3] = \"BadString\";\n  TokenType[TokenType[\"UnquotedString\"] = 4] = \"UnquotedString\";\n  TokenType[TokenType[\"Hash\"] = 5] = \"Hash\";\n  TokenType[TokenType[\"Num\"] = 6] = \"Num\";\n  TokenType[TokenType[\"Percentage\"] = 7] = \"Percentage\";\n  TokenType[TokenType[\"Dimension\"] = 8] = \"Dimension\";\n  TokenType[TokenType[\"UnicodeRange\"] = 9] = \"UnicodeRange\";\n  TokenType[TokenType[\"CDO\"] = 10] = \"CDO\";\n  TokenType[TokenType[\"CDC\"] = 11] = \"CDC\";\n  TokenType[TokenType[\"Colon\"] = 12] = \"Colon\";\n  TokenType[TokenType[\"SemiColon\"] = 13] = \"SemiColon\";\n  TokenType[TokenType[\"CurlyL\"] = 14] = \"CurlyL\";\n  TokenType[TokenType[\"CurlyR\"] = 15] = \"CurlyR\";\n  TokenType[TokenType[\"ParenthesisL\"] = 16] = \"ParenthesisL\";\n  TokenType[TokenType[\"ParenthesisR\"] = 17] = \"ParenthesisR\";\n  TokenType[TokenType[\"BracketL\"] = 18] = \"BracketL\";\n  TokenType[TokenType[\"BracketR\"] = 19] = \"BracketR\";\n  TokenType[TokenType[\"Whitespace\"] = 20] = \"Whitespace\";\n  TokenType[TokenType[\"Includes\"] = 21] = \"Includes\";\n  TokenType[TokenType[\"Dashmatch\"] = 22] = \"Dashmatch\";\n  TokenType[TokenType[\"SubstringOperator\"] = 23] = \"SubstringOperator\";\n  TokenType[TokenType[\"PrefixOperator\"] = 24] = \"PrefixOperator\";\n  TokenType[TokenType[\"SuffixOperator\"] = 25] = \"SuffixOperator\";\n  TokenType[TokenType[\"Delim\"] = 26] = \"Delim\";\n  TokenType[TokenType[\"EMS\"] = 27] = \"EMS\";\n  TokenType[TokenType[\"EXS\"] = 28] = \"EXS\";\n  TokenType[TokenType[\"Length\"] = 29] = \"Length\";\n  TokenType[TokenType[\"Angle\"] = 30] = \"Angle\";\n  TokenType[TokenType[\"Time\"] = 31] = \"Time\";\n  TokenType[TokenType[\"Freq\"] = 32] = \"Freq\";\n  TokenType[TokenType[\"Exclamation\"] = 33] = \"Exclamation\";\n  TokenType[TokenType[\"Resolution\"] = 34] = \"Resolution\";\n  TokenType[TokenType[\"Comma\"] = 35] = \"Comma\";\n  TokenType[TokenType[\"Charset\"] = 36] = \"Charset\";\n  TokenType[TokenType[\"EscapedJavaScript\"] = 37] = \"EscapedJavaScript\";\n  TokenType[TokenType[\"BadEscapedJavaScript\"] = 38] = \"BadEscapedJavaScript\";\n  TokenType[TokenType[\"Comment\"] = 39] = \"Comment\";\n  TokenType[TokenType[\"SingleLineComment\"] = 40] = \"SingleLineComment\";\n  TokenType[TokenType[\"EOF\"] = 41] = \"EOF\";\n  TokenType[TokenType[\"CustomToken\"] = 42] = \"CustomToken\";\n})(TokenType || (TokenType = {}));\n\nvar MultiLineStream =\n/** @class */\nfunction () {\n  function MultiLineStream(source) {\n    this.source = source;\n    this.len = source.length;\n    this.position = 0;\n  }\n\n  MultiLineStream.prototype.substring = function (from, to) {\n    if (to === void 0) {\n      to = this.position;\n    }\n\n    return this.source.substring(from, to);\n  };\n\n  MultiLineStream.prototype.eos = function () {\n    return this.len <= this.position;\n  };\n\n  MultiLineStream.prototype.pos = function () {\n    return this.position;\n  };\n\n  MultiLineStream.prototype.goBackTo = function (pos) {\n    this.position = pos;\n  };\n\n  MultiLineStream.prototype.goBack = function (n) {\n    this.position -= n;\n  };\n\n  MultiLineStream.prototype.advance = function (n) {\n    this.position += n;\n  };\n\n  MultiLineStream.prototype.nextChar = function () {\n    return this.source.charCodeAt(this.position++) || 0;\n  };\n\n  MultiLineStream.prototype.peekChar = function (n) {\n    if (n === void 0) {\n      n = 0;\n    }\n\n    return this.source.charCodeAt(this.position + n) || 0;\n  };\n\n  MultiLineStream.prototype.lookbackChar = function (n) {\n    if (n === void 0) {\n      n = 0;\n    }\n\n    return this.source.charCodeAt(this.position - n) || 0;\n  };\n\n  MultiLineStream.prototype.advanceIfChar = function (ch) {\n    if (ch === this.source.charCodeAt(this.position)) {\n      this.position++;\n      return true;\n    }\n\n    return false;\n  };\n\n  MultiLineStream.prototype.advanceIfChars = function (ch) {\n    if (this.position + ch.length > this.source.length) {\n      return false;\n    }\n\n    var i = 0;\n\n    for (; i < ch.length; i++) {\n      if (this.source.charCodeAt(this.position + i) !== ch[i]) {\n        return false;\n      }\n    }\n\n    this.advance(i);\n    return true;\n  };\n\n  MultiLineStream.prototype.advanceWhileChar = function (condition) {\n    var posNow = this.position;\n\n    while (this.position < this.len && condition(this.source.charCodeAt(this.position))) {\n      this.position++;\n    }\n\n    return this.position - posNow;\n  };\n\n  return MultiLineStream;\n}();\n\nexport { MultiLineStream };\n\nvar _a = 'a'.charCodeAt(0);\n\nvar _f = 'f'.charCodeAt(0);\n\nvar _z = 'z'.charCodeAt(0);\n\nvar _A = 'A'.charCodeAt(0);\n\nvar _F = 'F'.charCodeAt(0);\n\nvar _Z = 'Z'.charCodeAt(0);\n\nvar _0 = '0'.charCodeAt(0);\n\nvar _9 = '9'.charCodeAt(0);\n\nvar _TLD = '~'.charCodeAt(0);\n\nvar _HAT = '^'.charCodeAt(0);\n\nvar _EQS = '='.charCodeAt(0);\n\nvar _PIP = '|'.charCodeAt(0);\n\nvar _MIN = '-'.charCodeAt(0);\n\nvar _USC = '_'.charCodeAt(0);\n\nvar _PRC = '%'.charCodeAt(0);\n\nvar _MUL = '*'.charCodeAt(0);\n\nvar _LPA = '('.charCodeAt(0);\n\nvar _RPA = ')'.charCodeAt(0);\n\nvar _LAN = '<'.charCodeAt(0);\n\nvar _RAN = '>'.charCodeAt(0);\n\nvar _ATS = '@'.charCodeAt(0);\n\nvar _HSH = '#'.charCodeAt(0);\n\nvar _DLR = '$'.charCodeAt(0);\n\nvar _BSL = '\\\\'.charCodeAt(0);\n\nvar _FSL = '/'.charCodeAt(0);\n\nvar _NWL = '\\n'.charCodeAt(0);\n\nvar _CAR = '\\r'.charCodeAt(0);\n\nvar _LFD = '\\f'.charCodeAt(0);\n\nvar _DQO = '\"'.charCodeAt(0);\n\nvar _SQO = '\\''.charCodeAt(0);\n\nvar _WSP = ' '.charCodeAt(0);\n\nvar _TAB = '\\t'.charCodeAt(0);\n\nvar _SEM = ';'.charCodeAt(0);\n\nvar _COL = ':'.charCodeAt(0);\n\nvar _CUL = '{'.charCodeAt(0);\n\nvar _CUR = '}'.charCodeAt(0);\n\nvar _BRL = '['.charCodeAt(0);\n\nvar _BRR = ']'.charCodeAt(0);\n\nvar _CMA = ','.charCodeAt(0);\n\nvar _DOT = '.'.charCodeAt(0);\n\nvar _BNG = '!'.charCodeAt(0);\n\nvar staticTokenTable = {};\nstaticTokenTable[_SEM] = TokenType.SemiColon;\nstaticTokenTable[_COL] = TokenType.Colon;\nstaticTokenTable[_CUL] = TokenType.CurlyL;\nstaticTokenTable[_CUR] = TokenType.CurlyR;\nstaticTokenTable[_BRR] = TokenType.BracketR;\nstaticTokenTable[_BRL] = TokenType.BracketL;\nstaticTokenTable[_LPA] = TokenType.ParenthesisL;\nstaticTokenTable[_RPA] = TokenType.ParenthesisR;\nstaticTokenTable[_CMA] = TokenType.Comma;\nvar staticUnitTable = {};\nstaticUnitTable['em'] = TokenType.EMS;\nstaticUnitTable['ex'] = TokenType.EXS;\nstaticUnitTable['px'] = TokenType.Length;\nstaticUnitTable['cm'] = TokenType.Length;\nstaticUnitTable['mm'] = TokenType.Length;\nstaticUnitTable['in'] = TokenType.Length;\nstaticUnitTable['pt'] = TokenType.Length;\nstaticUnitTable['pc'] = TokenType.Length;\nstaticUnitTable['deg'] = TokenType.Angle;\nstaticUnitTable['rad'] = TokenType.Angle;\nstaticUnitTable['grad'] = TokenType.Angle;\nstaticUnitTable['ms'] = TokenType.Time;\nstaticUnitTable['s'] = TokenType.Time;\nstaticUnitTable['hz'] = TokenType.Freq;\nstaticUnitTable['khz'] = TokenType.Freq;\nstaticUnitTable['%'] = TokenType.Percentage;\nstaticUnitTable['fr'] = TokenType.Percentage;\nstaticUnitTable['dpi'] = TokenType.Resolution;\nstaticUnitTable['dpcm'] = TokenType.Resolution;\n\nvar Scanner =\n/** @class */\nfunction () {\n  function Scanner() {\n    this.stream = new MultiLineStream('');\n    this.ignoreComment = true;\n    this.ignoreWhitespace = true;\n    this.inURL = false;\n  }\n\n  Scanner.prototype.setSource = function (input) {\n    this.stream = new MultiLineStream(input);\n  };\n\n  Scanner.prototype.finishToken = function (offset, type, text) {\n    return {\n      offset: offset,\n      len: this.stream.pos() - offset,\n      type: type,\n      text: text || this.stream.substring(offset)\n    };\n  };\n\n  Scanner.prototype.substring = function (offset, len) {\n    return this.stream.substring(offset, offset + len);\n  };\n\n  Scanner.prototype.pos = function () {\n    return this.stream.pos();\n  };\n\n  Scanner.prototype.goBackTo = function (pos) {\n    this.stream.goBackTo(pos);\n  };\n\n  Scanner.prototype.scanUnquotedString = function () {\n    var offset = this.stream.pos();\n    var content = [];\n\n    if (this._unquotedString(content)) {\n      return this.finishToken(offset, TokenType.UnquotedString, content.join(''));\n    }\n\n    return null;\n  };\n\n  Scanner.prototype.scan = function () {\n    // processes all whitespaces and comments\n    var triviaToken = this.trivia();\n\n    if (triviaToken !== null) {\n      return triviaToken;\n    }\n\n    var offset = this.stream.pos(); // End of file/input\n\n    if (this.stream.eos()) {\n      return this.finishToken(offset, TokenType.EOF);\n    }\n\n    return this.scanNext(offset);\n  };\n\n  Scanner.prototype.scanNext = function (offset) {\n    // CDO <!--\n    if (this.stream.advanceIfChars([_LAN, _BNG, _MIN, _MIN])) {\n      return this.finishToken(offset, TokenType.CDO);\n    } // CDC -->\n\n\n    if (this.stream.advanceIfChars([_MIN, _MIN, _RAN])) {\n      return this.finishToken(offset, TokenType.CDC);\n    }\n\n    var content = [];\n\n    if (this.ident(content)) {\n      return this.finishToken(offset, TokenType.Ident, content.join(''));\n    } // at-keyword\n\n\n    if (this.stream.advanceIfChar(_ATS)) {\n      content = ['@'];\n\n      if (this._name(content)) {\n        var keywordText = content.join('');\n\n        if (keywordText === '@charset') {\n          return this.finishToken(offset, TokenType.Charset, keywordText);\n        }\n\n        return this.finishToken(offset, TokenType.AtKeyword, keywordText);\n      } else {\n        return this.finishToken(offset, TokenType.Delim);\n      }\n    } // hash\n\n\n    if (this.stream.advanceIfChar(_HSH)) {\n      content = ['#'];\n\n      if (this._name(content)) {\n        return this.finishToken(offset, TokenType.Hash, content.join(''));\n      } else {\n        return this.finishToken(offset, TokenType.Delim);\n      }\n    } // Important\n\n\n    if (this.stream.advanceIfChar(_BNG)) {\n      return this.finishToken(offset, TokenType.Exclamation);\n    } // Numbers\n\n\n    if (this._number()) {\n      var pos = this.stream.pos();\n      content = [this.stream.substring(offset, pos)];\n\n      if (this.stream.advanceIfChar(_PRC)) {\n        // Percentage 43%\n        return this.finishToken(offset, TokenType.Percentage);\n      } else if (this.ident(content)) {\n        var dim = this.stream.substring(pos).toLowerCase();\n        var tokenType_1 = staticUnitTable[dim];\n\n        if (typeof tokenType_1 !== 'undefined') {\n          // Known dimension 43px\n          return this.finishToken(offset, tokenType_1, content.join(''));\n        } else {\n          // Unknown dimension 43ft\n          return this.finishToken(offset, TokenType.Dimension, content.join(''));\n        }\n      }\n\n      return this.finishToken(offset, TokenType.Num);\n    } // String, BadString\n\n\n    content = [];\n\n    var tokenType = this._string(content);\n\n    if (tokenType !== null) {\n      return this.finishToken(offset, tokenType, content.join(''));\n    } // single character tokens\n\n\n    tokenType = staticTokenTable[this.stream.peekChar()];\n\n    if (typeof tokenType !== 'undefined') {\n      this.stream.advance(1);\n      return this.finishToken(offset, tokenType);\n    } // includes ~=\n\n\n    if (this.stream.peekChar(0) === _TLD && this.stream.peekChar(1) === _EQS) {\n      this.stream.advance(2);\n      return this.finishToken(offset, TokenType.Includes);\n    } // DashMatch |=\n\n\n    if (this.stream.peekChar(0) === _PIP && this.stream.peekChar(1) === _EQS) {\n      this.stream.advance(2);\n      return this.finishToken(offset, TokenType.Dashmatch);\n    } // Substring operator *=\n\n\n    if (this.stream.peekChar(0) === _MUL && this.stream.peekChar(1) === _EQS) {\n      this.stream.advance(2);\n      return this.finishToken(offset, TokenType.SubstringOperator);\n    } // Substring operator ^=\n\n\n    if (this.stream.peekChar(0) === _HAT && this.stream.peekChar(1) === _EQS) {\n      this.stream.advance(2);\n      return this.finishToken(offset, TokenType.PrefixOperator);\n    } // Substring operator $=\n\n\n    if (this.stream.peekChar(0) === _DLR && this.stream.peekChar(1) === _EQS) {\n      this.stream.advance(2);\n      return this.finishToken(offset, TokenType.SuffixOperator);\n    } // Delim\n\n\n    this.stream.nextChar();\n    return this.finishToken(offset, TokenType.Delim);\n  };\n\n  Scanner.prototype._matchWordAnyCase = function (characters) {\n    var index = 0;\n    this.stream.advanceWhileChar(function (ch) {\n      var result = characters[index] === ch || characters[index + 1] === ch;\n\n      if (result) {\n        index += 2;\n      }\n\n      return result;\n    });\n\n    if (index === characters.length) {\n      return true;\n    } else {\n      this.stream.goBack(index / 2);\n      return false;\n    }\n  };\n\n  Scanner.prototype.trivia = function () {\n    while (true) {\n      var offset = this.stream.pos();\n\n      if (this._whitespace()) {\n        if (!this.ignoreWhitespace) {\n          return this.finishToken(offset, TokenType.Whitespace);\n        }\n      } else if (this.comment()) {\n        if (!this.ignoreComment) {\n          return this.finishToken(offset, TokenType.Comment);\n        }\n      } else {\n        return null;\n      }\n    }\n  };\n\n  Scanner.prototype.comment = function () {\n    if (this.stream.advanceIfChars([_FSL, _MUL])) {\n      var success_1 = false,\n          hot_1 = false;\n      this.stream.advanceWhileChar(function (ch) {\n        if (hot_1 && ch === _FSL) {\n          success_1 = true;\n          return false;\n        }\n\n        hot_1 = ch === _MUL;\n        return true;\n      });\n\n      if (success_1) {\n        this.stream.advance(1);\n      }\n\n      return true;\n    }\n\n    return false;\n  };\n\n  Scanner.prototype._number = function () {\n    var npeek = 0,\n        ch;\n\n    if (this.stream.peekChar() === _DOT) {\n      npeek = 1;\n    }\n\n    ch = this.stream.peekChar(npeek);\n\n    if (ch >= _0 && ch <= _9) {\n      this.stream.advance(npeek + 1);\n      this.stream.advanceWhileChar(function (ch) {\n        return ch >= _0 && ch <= _9 || npeek === 0 && ch === _DOT;\n      });\n      return true;\n    }\n\n    return false;\n  };\n\n  Scanner.prototype._newline = function (result) {\n    var ch = this.stream.peekChar();\n\n    switch (ch) {\n      case _CAR:\n      case _LFD:\n      case _NWL:\n        this.stream.advance(1);\n        result.push(String.fromCharCode(ch));\n\n        if (ch === _CAR && this.stream.advanceIfChar(_NWL)) {\n          result.push('\\n');\n        }\n\n        return true;\n    }\n\n    return false;\n  };\n\n  Scanner.prototype._escape = function (result, includeNewLines) {\n    var ch = this.stream.peekChar();\n\n    if (ch === _BSL) {\n      this.stream.advance(1);\n      ch = this.stream.peekChar();\n      var hexNumCount = 0;\n\n      while (hexNumCount < 6 && (ch >= _0 && ch <= _9 || ch >= _a && ch <= _f || ch >= _A && ch <= _F)) {\n        this.stream.advance(1);\n        ch = this.stream.peekChar();\n        hexNumCount++;\n      }\n\n      if (hexNumCount > 0) {\n        try {\n          var hexVal = parseInt(this.stream.substring(this.stream.pos() - hexNumCount), 16);\n\n          if (hexVal) {\n            result.push(String.fromCharCode(hexVal));\n          }\n        } catch (e) {} // ignore\n        // optional whitespace or new line, not part of result text\n\n\n        if (ch === _WSP || ch === _TAB) {\n          this.stream.advance(1);\n        } else {\n          this._newline([]);\n        }\n\n        return true;\n      }\n\n      if (ch !== _CAR && ch !== _LFD && ch !== _NWL) {\n        this.stream.advance(1);\n        result.push(String.fromCharCode(ch));\n        return true;\n      } else if (includeNewLines) {\n        return this._newline(result);\n      }\n    }\n\n    return false;\n  };\n\n  Scanner.prototype._stringChar = function (closeQuote, result) {\n    // not closeQuote, not backslash, not newline\n    var ch = this.stream.peekChar();\n\n    if (ch !== 0 && ch !== closeQuote && ch !== _BSL && ch !== _CAR && ch !== _LFD && ch !== _NWL) {\n      this.stream.advance(1);\n      result.push(String.fromCharCode(ch));\n      return true;\n    }\n\n    return false;\n  };\n\n  Scanner.prototype._string = function (result) {\n    if (this.stream.peekChar() === _SQO || this.stream.peekChar() === _DQO) {\n      var closeQuote = this.stream.nextChar();\n      result.push(String.fromCharCode(closeQuote));\n\n      while (this._stringChar(closeQuote, result) || this._escape(result, true)) {// loop\n      }\n\n      if (this.stream.peekChar() === closeQuote) {\n        this.stream.nextChar();\n        result.push(String.fromCharCode(closeQuote));\n        return TokenType.String;\n      } else {\n        return TokenType.BadString;\n      }\n    }\n\n    return null;\n  };\n\n  Scanner.prototype._unquotedChar = function (result) {\n    // not closeQuote, not backslash, not newline\n    var ch = this.stream.peekChar();\n\n    if (ch !== 0 && ch !== _BSL && ch !== _SQO && ch !== _DQO && ch !== _LPA && ch !== _RPA && ch !== _WSP && ch !== _TAB && ch !== _NWL && ch !== _LFD && ch !== _CAR) {\n      this.stream.advance(1);\n      result.push(String.fromCharCode(ch));\n      return true;\n    }\n\n    return false;\n  };\n\n  Scanner.prototype._unquotedString = function (result) {\n    var hasContent = false;\n\n    while (this._unquotedChar(result) || this._escape(result)) {\n      hasContent = true;\n    }\n\n    return hasContent;\n  };\n\n  Scanner.prototype._whitespace = function () {\n    var n = this.stream.advanceWhileChar(function (ch) {\n      return ch === _WSP || ch === _TAB || ch === _NWL || ch === _LFD || ch === _CAR;\n    });\n    return n > 0;\n  };\n\n  Scanner.prototype._name = function (result) {\n    var matched = false;\n\n    while (this._identChar(result) || this._escape(result)) {\n      matched = true;\n    }\n\n    return matched;\n  };\n\n  Scanner.prototype.ident = function (result) {\n    var pos = this.stream.pos();\n\n    var hasMinus = this._minus(result);\n\n    if (hasMinus && this._minus(result)\n    /* -- */\n    ) {\n      if (this._identFirstChar(result) || this._escape(result)) {\n        while (this._identChar(result) || this._escape(result)) {// loop\n        }\n\n        return true;\n      }\n    } else if (this._identFirstChar(result) || this._escape(result)) {\n      while (this._identChar(result) || this._escape(result)) {// loop\n      }\n\n      return true;\n    }\n\n    this.stream.goBackTo(pos);\n    return false;\n  };\n\n  Scanner.prototype._identFirstChar = function (result) {\n    var ch = this.stream.peekChar();\n\n    if (ch === _USC || // _\n    ch >= _a && ch <= _z || // a-z\n    ch >= _A && ch <= _Z || // A-Z\n    ch >= 0x80 && ch <= 0xFFFF) {\n      // nonascii\n      this.stream.advance(1);\n      result.push(String.fromCharCode(ch));\n      return true;\n    }\n\n    return false;\n  };\n\n  Scanner.prototype._minus = function (result) {\n    var ch = this.stream.peekChar();\n\n    if (ch === _MIN) {\n      this.stream.advance(1);\n      result.push(String.fromCharCode(ch));\n      return true;\n    }\n\n    return false;\n  };\n\n  Scanner.prototype._identChar = function (result) {\n    var ch = this.stream.peekChar();\n\n    if (ch === _USC || // _\n    ch === _MIN || // -\n    ch >= _a && ch <= _z || // a-z\n    ch >= _A && ch <= _Z || // A-Z\n    ch >= _0 && ch <= _9 || // 0/9\n    ch >= 0x80 && ch <= 0xFFFF) {\n      // nonascii\n      this.stream.advance(1);\n      result.push(String.fromCharCode(ch));\n      return true;\n    }\n\n    return false;\n  };\n\n  return Scanner;\n}();\n\nexport { Scanner };","map":null,"metadata":{},"sourceType":"module"}