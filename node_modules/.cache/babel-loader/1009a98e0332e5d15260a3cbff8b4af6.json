{"ast":null,"code":"/*\nThe MIT License (MIT)\n\nCopyright Â© 2015 Nicolas Bevacqua\n\nPermission is hereby granted, free of charge, to any person obtaining a copy of\nthis software and associated documentation files (the \"Software\"), to deal in\nthe Software without restriction, including without limitation the rights to\nuse, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of\nthe Software, and to permit persons to whom the Software is furnished to do so,\nsubject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in all\ncopies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS\nFOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR\nCOPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER\nIN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN\nCONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.\n*/\nlet __insane_func;\n\n(function () {\n  function r(e, n, t) {\n    function o(i, f) {\n      if (!n[i]) {\n        if (!e[i]) {\n          var c = \"function\" == typeof require && require;\n          if (!f && c) return c(i, !0);\n          if (u) return u(i, !0);\n          var a = new Error(\"Cannot find module '\" + i + \"'\");\n          throw a.code = \"MODULE_NOT_FOUND\", a;\n        }\n\n        var p = n[i] = {\n          exports: {}\n        };\n        e[i][0].call(p.exports, function (r) {\n          var n = e[i][1][r];\n          return o(n || r);\n        }, p, p.exports, r, e, n, t);\n      }\n\n      return n[i].exports;\n    }\n\n    for (var u = \"function\" == typeof require && require, i = 0; i < t.length; i++) o(t[i]);\n\n    return o;\n  }\n\n  return r;\n})()({\n  1: [function (require, module, exports) {\n    'use strict';\n\n    var toMap = require('./toMap');\n\n    var uris = ['background', 'base', 'cite', 'href', 'longdesc', 'src', 'usemap'];\n    module.exports = {\n      uris: toMap(uris) // attributes that have an href and hence need to be sanitized\n\n    };\n  }, {\n    \"./toMap\": 10\n  }],\n  2: [function (require, module, exports) {\n    'use strict';\n\n    var defaults = {\n      allowedAttributes: {\n        '*': ['title', 'accesskey'],\n        a: ['href', 'name', 'target', 'aria-label'],\n        iframe: ['allowfullscreen', 'frameborder', 'src'],\n        img: ['src', 'alt', 'title', 'aria-label']\n      },\n      allowedClasses: {},\n      allowedSchemes: ['http', 'https', 'mailto'],\n      allowedTags: ['a', 'abbr', 'article', 'b', 'blockquote', 'br', 'caption', 'code', 'del', 'details', 'div', 'em', 'h1', 'h2', 'h3', 'h4', 'h5', 'h6', 'hr', 'i', 'img', 'ins', 'kbd', 'li', 'main', 'mark', 'ol', 'p', 'pre', 'section', 'span', 'strike', 'strong', 'sub', 'summary', 'sup', 'table', 'tbody', 'td', 'th', 'thead', 'tr', 'u', 'ul'],\n      filter: null\n    };\n    module.exports = defaults;\n  }, {}],\n  3: [function (require, module, exports) {\n    'use strict';\n\n    var toMap = require('./toMap');\n\n    var voids = ['area', 'br', 'col', 'hr', 'img', 'wbr', 'input', 'base', 'basefont', 'link', 'meta'];\n    module.exports = {\n      voids: toMap(voids)\n    };\n  }, {\n    \"./toMap\": 10\n  }],\n  4: [function (require, module, exports) {\n    'use strict';\n\n    var he = require('he');\n\n    var assign = require('assignment');\n\n    var parser = require('./parser');\n\n    var sanitizer = require('./sanitizer');\n\n    var defaults = require('./defaults');\n\n    function insane(html, options, strict) {\n      var buffer = [];\n      var configuration = strict === true ? options : assign({}, defaults, options);\n      var handler = sanitizer(buffer, configuration);\n      parser(html, handler);\n      return buffer.join('');\n    }\n\n    insane.defaults = defaults;\n    module.exports = insane;\n    __insane_func = insane;\n  }, {\n    \"./defaults\": 2,\n    \"./parser\": 7,\n    \"./sanitizer\": 8,\n    \"assignment\": 6,\n    \"he\": 9\n  }],\n  5: [function (require, module, exports) {\n    'use strict';\n\n    module.exports = function lowercase(string) {\n      return typeof string === 'string' ? string.toLowerCase() : string;\n    };\n  }, {}],\n  6: [function (require, module, exports) {\n    'use strict';\n\n    function assignment(result) {\n      var stack = Array.prototype.slice.call(arguments, 1);\n      var item;\n      var key;\n\n      while (stack.length) {\n        item = stack.shift();\n\n        for (key in item) {\n          if (item.hasOwnProperty(key)) {\n            if (Object.prototype.toString.call(result[key]) === '[object Object]') {\n              result[key] = assignment(result[key], item[key]);\n            } else {\n              result[key] = item[key];\n            }\n          }\n        }\n      }\n\n      return result;\n    }\n\n    module.exports = assignment;\n  }, {}],\n  7: [function (require, module, exports) {\n    'use strict';\n\n    var he = require('he');\n\n    var lowercase = require('./lowercase');\n\n    var attributes = require('./attributes');\n\n    var elements = require('./elements');\n\n    var rstart = /^<\\s*([\\w:-]+)((?:\\s+[\\w:-]+(?:\\s*=\\s*(?:(?:\"[^\"]*\")|(?:'[^']*')|[^>\\s]+))?)*)\\s*(\\/?)\\s*>/;\n    var rend = /^<\\s*\\/\\s*([\\w:-]+)[^>]*>/;\n    var rattrs = /([\\w:-]+)(?:\\s*=\\s*(?:(?:\"((?:[^\"])*)\")|(?:'((?:[^'])*)')|([^>\\s]+)))?/g;\n    var rtag = /^</;\n    var rtagend = /^<\\s*\\//;\n\n    function createStack() {\n      var stack = [];\n\n      stack.lastItem = function lastItem() {\n        return stack[stack.length - 1];\n      };\n\n      return stack;\n    }\n\n    function parser(html, handler) {\n      var stack = createStack();\n      var last = html;\n      var chars;\n\n      while (html) {\n        parsePart();\n      }\n\n      parseEndTag(); // clean up any remaining tags\n\n      function parsePart() {\n        chars = true;\n        parseTag();\n        var same = html === last;\n        last = html;\n\n        if (same) {\n          // discard, because it's invalid\n          html = '';\n        }\n      }\n\n      function parseTag() {\n        if (html.substr(0, 4) === '<!--') {\n          // comments\n          parseComment();\n        } else if (rtagend.test(html)) {\n          parseEdge(rend, parseEndTag);\n        } else if (rtag.test(html)) {\n          parseEdge(rstart, parseStartTag);\n        }\n\n        parseTagDecode();\n      }\n\n      function parseEdge(regex, parser) {\n        var match = html.match(regex);\n\n        if (match) {\n          html = html.substring(match[0].length);\n          match[0].replace(regex, parser);\n          chars = false;\n        }\n      }\n\n      function parseComment() {\n        var index = html.indexOf('-->');\n\n        if (index >= 0) {\n          if (handler.comment) {\n            handler.comment(html.substring(4, index));\n          }\n\n          html = html.substring(index + 3);\n          chars = false;\n        }\n      }\n\n      function parseTagDecode() {\n        if (!chars) {\n          return;\n        }\n\n        var text;\n        var index = html.indexOf('<');\n\n        if (index >= 0) {\n          text = html.substring(0, index);\n          html = html.substring(index);\n        } else {\n          text = html;\n          html = '';\n        }\n\n        if (handler.chars) {\n          handler.chars(text);\n        }\n      }\n\n      function parseStartTag(tag, tagName, rest, unary) {\n        var attrs = {};\n        var low = lowercase(tagName);\n        var u = elements.voids[low] || !!unary;\n        rest.replace(rattrs, attrReplacer);\n\n        if (!u) {\n          stack.push(low);\n        }\n\n        if (handler.start) {\n          handler.start(low, attrs, u);\n        }\n\n        function attrReplacer(match, name, doubleQuotedValue, singleQuotedValue, unquotedValue) {\n          if (doubleQuotedValue === void 0 && singleQuotedValue === void 0 && unquotedValue === void 0) {\n            attrs[name] = void 0; // attribute is like <button disabled></button>\n          } else {\n            attrs[name] = he.decode(doubleQuotedValue || singleQuotedValue || unquotedValue || '');\n          }\n        }\n      }\n\n      function parseEndTag(tag, tagName) {\n        var i;\n        var pos = 0;\n        var low = lowercase(tagName);\n\n        if (low) {\n          for (pos = stack.length - 1; pos >= 0; pos--) {\n            if (stack[pos] === low) {\n              break; // find the closest opened tag of the same type\n            }\n          }\n        }\n\n        if (pos >= 0) {\n          for (i = stack.length - 1; i >= pos; i--) {\n            if (handler.end) {\n              // close all the open elements, up the stack\n              handler.end(stack[i]);\n            }\n          }\n\n          stack.length = pos;\n        }\n      }\n    }\n\n    module.exports = parser;\n  }, {\n    \"./attributes\": 1,\n    \"./elements\": 3,\n    \"./lowercase\": 5,\n    \"he\": 9\n  }],\n  8: [function (require, module, exports) {\n    'use strict';\n\n    var he = require('he');\n\n    var lowercase = require('./lowercase');\n\n    var attributes = require('./attributes');\n\n    var elements = require('./elements');\n\n    function sanitizer(buffer, options) {\n      var last;\n      var context;\n      var o = options || {};\n      reset();\n      return {\n        start: start,\n        end: end,\n        chars: chars\n      };\n\n      function out(value) {\n        buffer.push(value);\n      }\n\n      function start(tag, attrs, unary) {\n        var low = lowercase(tag);\n\n        if (context.ignoring) {\n          ignore(low);\n          return;\n        }\n\n        if ((o.allowedTags || []).indexOf(low) === -1) {\n          ignore(low);\n          return;\n        }\n\n        if (o.filter && !o.filter({\n          tag: low,\n          attrs: attrs\n        })) {\n          ignore(low);\n          return;\n        }\n\n        out('<');\n        out(low);\n        Object.keys(attrs).forEach(parse);\n        out(unary ? '/>' : '>');\n\n        function parse(key) {\n          var value = attrs[key];\n          var classesOk = (o.allowedClasses || {})[low] || [];\n          var attrsOk = (o.allowedAttributes || {})[low] || [];\n          attrsOk = attrsOk.concat((o.allowedAttributes || {})['*'] || []);\n          var valid;\n          var lkey = lowercase(key);\n\n          if (lkey === 'class' && attrsOk.indexOf(lkey) === -1) {\n            value = value.split(' ').filter(isValidClass).join(' ').trim();\n            valid = value.length;\n          } else {\n            valid = attrsOk.indexOf(lkey) !== -1 && (attributes.uris[lkey] !== true || testUrl(value));\n          }\n\n          if (valid) {\n            out(' ');\n            out(key);\n\n            if (typeof value === 'string') {\n              out('=\"');\n              out(he.encode(value));\n              out('\"');\n            }\n          }\n\n          function isValidClass(className) {\n            return classesOk && classesOk.indexOf(className) !== -1;\n          }\n        }\n      }\n\n      function end(tag) {\n        var low = lowercase(tag);\n        var allowed = (o.allowedTags || []).indexOf(low) !== -1;\n\n        if (allowed) {\n          if (context.ignoring === false) {\n            out('</');\n            out(low);\n            out('>');\n          } else {\n            unignore(low);\n          }\n        } else {\n          unignore(low);\n        }\n      }\n\n      function testUrl(text) {\n        var start = text[0];\n\n        if (start === '#' || start === '/') {\n          return true;\n        }\n\n        var colon = text.indexOf(':');\n\n        if (colon === -1) {\n          return true;\n        }\n\n        var questionmark = text.indexOf('?');\n\n        if (questionmark !== -1 && colon > questionmark) {\n          return true;\n        }\n\n        var hash = text.indexOf('#');\n\n        if (hash !== -1 && colon > hash) {\n          return true;\n        }\n\n        return o.allowedSchemes.some(matches);\n\n        function matches(scheme) {\n          return text.indexOf(scheme + ':') === 0;\n        }\n      }\n\n      function chars(text) {\n        if (context.ignoring === false) {\n          out(o.transformText ? o.transformText(text) : text);\n        }\n      }\n\n      function ignore(tag) {\n        if (elements.voids[tag]) {\n          return;\n        }\n\n        if (context.ignoring === false) {\n          context = {\n            ignoring: tag,\n            depth: 1\n          };\n        } else if (context.ignoring === tag) {\n          context.depth++;\n        }\n      }\n\n      function unignore(tag) {\n        if (context.ignoring === tag) {\n          if (--context.depth <= 0) {\n            reset();\n          }\n        }\n      }\n\n      function reset() {\n        context = {\n          ignoring: false,\n          depth: 0\n        };\n      }\n    }\n\n    module.exports = sanitizer;\n  }, {\n    \"./attributes\": 1,\n    \"./elements\": 3,\n    \"./lowercase\": 5,\n    \"he\": 9\n  }],\n  9: [function (require, module, exports) {\n    'use strict';\n\n    var escapes = {\n      '&': '&amp;',\n      '<': '&lt;',\n      '>': '&gt;',\n      '\"': '&quot;',\n      \"'\": '&#39;'\n    };\n    var unescapes = {\n      '&amp;': '&',\n      '&lt;': '<',\n      '&gt;': '>',\n      '&quot;': '\"',\n      '&#39;': \"'\"\n    };\n    var rescaped = /(&amp;|&lt;|&gt;|&quot;|&#39;)/g;\n    var runescaped = /[&<>\"']/g;\n\n    function escapeHtmlChar(match) {\n      return escapes[match];\n    }\n\n    function unescapeHtmlChar(match) {\n      return unescapes[match];\n    }\n\n    function escapeHtml(text) {\n      return text == null ? '' : String(text).replace(runescaped, escapeHtmlChar);\n    }\n\n    function unescapeHtml(html) {\n      return html == null ? '' : String(html).replace(rescaped, unescapeHtmlChar);\n    }\n\n    escapeHtml.options = unescapeHtml.options = {};\n    module.exports = {\n      encode: escapeHtml,\n      escape: escapeHtml,\n      decode: unescapeHtml,\n      unescape: unescapeHtml,\n      version: '1.0.0-browser'\n    };\n  }, {}],\n  10: [function (require, module, exports) {\n    'use strict';\n\n    function toMap(list) {\n      return list.reduce(asKey, {});\n    }\n\n    function asKey(accumulator, item) {\n      accumulator[item] = true;\n      return accumulator;\n    }\n\n    module.exports = toMap;\n  }, {}]\n}, {}, [4]); // ESM-comment-begin\n// define(function() { return { insane: __insane_func }; });\n// ESM-comment-end\n// ESM-uncomment-begin\n\nexport var insane = __insane_func; // ESM-uncomment-end","map":null,"metadata":{},"sourceType":"module"}